<!DOCTYPE html>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.js"></script>
<script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

<style>
    #map {
        height: 100vh;
    }
</style>

<div id="map"></div>

<script type="text/javascript">
    function InitialiserCarte() {
        var map = L.map('map').setView([
            48.8626304852, 2.33629344655
        ], 5);

        var tuileUrl = 'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}';

        var osm = L.tileLayer(tuileUrl, {
            minZoom: 0,
            maxZoom: 17
        });

        osm.addTo(map);

        const vienneGeoJson = {
            'type': 'Feature',
            'properties': { 'name': 'Vienne' },
            'geometry': {
                'type': 'Polygon',
                'coordinates': [[
                    [0.043, 46.984],
                    [0.498, 47.035],
                    [0.835, 46.862],
                    [0.916, 46.478],
                    [0.687, 46.212],
                    [0.243, 46.189],
                    [-0.086, 46.394],
                    [-0.091, 46.718],
                    [0.043, 46.984]
                ]]
            }
        };

        new L.GeoJSON.AJAX(['https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/departements-version-simplifiee.geojson'], {
            // style: function (feature) {
            //     switch (feature.properties.code) {
            //         case '16':
            //         case '22':
            //         case '29':
            //         case '35':
            //         case '37':
            //         case '44':
            //         case '49':
            //         case '56':
            //         case '79':
            //         case '85':
            //         case '86':
            //             return { color: "#ffed00" };
            //
            //         case '02':
            //         case '14':
            //         case '27':
            //         case '28':
            //         case '50':
            //         case '53':
            //         case '59':
            //         case '60':
            //         case '61':
            //         case '62':
            //         case '72':
            //         case '76':
            //         case '78':
            //         case '80':
            //             return { color: "#ef8200" };
            //     }
            // }
        }).addTo(map);

        map.on('click', function(e) {
            const lat = e.latlng.lat;
            const lng = e.latlng.lng;

            // Create a Turf point
            const point = turf.point([lng, lat]);

            // Check if inside Vienne
            const inside = turf.booleanPointInPolygon(point, vienneGeoJson);

            if (inside) {
                var popLocation = e.latlng;
                L.popup({ maxWidth: 600 })
                    .setLatLng(popLocation)
                    .setContent('<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/lJ6coOOoD3c?si=N1bEcJhZBtuLHCUm" title="YouTube video player"\n' +
                        '        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"\n' +
                        '        referrerpolicy="strict-origin-when-cross-origin"></iframe>')
                    .openOn(map);
            }
        });
    }

    $(document).ready(function() {
        InitialiserCarte();
    });</script>
</div>

</script>
</body>

</html>
